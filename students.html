      method: 'POST',
      headers: {'Content-Type': 'application/x-www-form-urlencoded'},
      body: new URLSearchParams({
        action: 'deleteStudent',
        role: 'principal',
        studentId: studentToDelete
      })
    });
    const data = await res.json();
    if (data.success) {
      btn.style.backgroundColor = 'green';
      showMessage('Student deleted successfully.');
      loadStudents();} else {
      btn.style.backgroundColor = 'red';
      showMessage('Failed to delete student: ' + data.message, true);
    }
  } catch (err) {
    btn.style.backgroundColor = 'red';
    showMessage('Error: ' + err.message, true);
  }
  setTimeout(() => {
    btn.style.backgroundColor = originalColor;
    btn.disabled = false;
    btn.textContent = 'Yes, Delete';
    cancelDelete();
  }, 1000);
});

function cancelDelete() {
  studentToDelete = null;
  document.getElementById('deleteConfirm').style.display = 'none';
}

function showMessage(msg, isError = false) {
  const messageDiv = document.getElementById('message');
  messageDiv.textContent = msg;
  messageDiv.style.color = isError ? 'red' : 'green';
}

function clearMessage() {
  document.getElementById('message').textContent = '';
}

// Edit Student
function editStudentById(studentID) {
  const student = loadedStudents.find(s => s.StudentID === studentID);
  if (!student) {
    showMessage('Student data not found for editing.', true);
    return;
  }
  document.getElementById('editStudentId').value = student.StudentID;
  document.getElementById('studentName').value = student.Name || '';
  document.getElementById('studentClass').value = student.Class || '';
  document.getElementById('studentStatus').value = student.Status || 'New';
  window.scrollTo({top: 0, behavior: 'smooth'});
}

// Initial load
loadStudents();
</script>

</body>
</html>
